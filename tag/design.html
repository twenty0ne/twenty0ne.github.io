<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>twenty0ne's blog - design</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">twenty0ne's blog </a></h1>
                <nav><ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/archives.html">Archives</a></li>
                    <li><a href="/tags.html">Tags</a></li>
                    <li><a href="/categories.html">Categories</a></li>
                </ul>
                </nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/posts/2015/10/how-to-design-game-config/">游戏配置如何更自由</a></h1>
<footer class="post-info">
        <span>四 22 十月 2015</span>
<span>| tags: <a href="/tag/game.html">game</a><a href="/tag/design.html">design</a></span>
</footer><!-- /.post-info --><p>印象中配置似乎是策划的事情，程序员将表格丢给策划后随便策划折腾。<br />
其实往往最痛苦的是在前期，策划的需求还没有确定，配置变来变去再正常不过，在这种情况下我不太建议开始设计表格，让策划来填写，最好的方式就是直接再程序里面写配置，比如TestConfig.h，这样修改起来更快捷更直观。  </p>
<p>那如何组织配置呢？我觉得这时候<strong>组合</strong>是更合理的方式。<br />
比如策划想在游戏中添加Item，可能需要用到如下属性</p>
<div class="highlight"><pre>            <span class="nt">struct</span> <span class="nt">Item</span> <span class="p">{</span>
                <span class="n">int</span>             <span class="n">uid</span><span class="p">;</span>
                <span class="n">std</span><span class="o">::</span><span class="n">string</span>     <span class="n">name</span><span class="p">;</span>
                <span class="n">int</span>             <span class="n">coin</span><span class="p">;</span>
            <span class="p">}</span><span class="o">;</span>
</pre></div>


<p>现在针对不同种类的物品，需要添加一些属性，可能等义就变为如下  </p>
<div class="highlight"><pre>            <span class="nt">struct</span> <span class="nt">Item</span> <span class="p">{</span>
                <span class="n">int</span>             <span class="n">uid</span><span class="p">;</span>
                <span class="n">std</span><span class="o">::</span><span class="n">string</span>     <span class="n">name</span><span class="p">;</span>
                <span class="n">int</span>             <span class="n">coin</span><span class="p">;</span>
                <span class="o">//...</span>
                <span class="n">int</span>             <span class="n">weight</span><span class="p">;</span>
                <span class="o">//...</span>
            <span class="p">}</span><span class="o">;</span>
</pre></div>


<p>好的过一段时间，你会发现配置表变为如下  </p>
<div class="highlight"><pre>            static Item gItemConfigs[] = {
                {0, &quot;item0&quot;, 1, ... , 10, ...},
                {1, &quot;item1&quot;, 2, ... , 10, ...},
                ...
            };
</pre></div>


<p>当需要修改，增减，将是一件特别痛苦的事情，这时候最好的方式就是<strong>拆分</strong>。  </p>
<div class="highlight"><pre>                struct Item {
                    // ...
                    int     type; // item type
                    int     uidprop; // item prop uid
                };
                struct ItemProp1 {
                    int     uidItem;    // 对应item uid
                    // ...
                };
                struct ItemProp2 {
                    int     uidItem;
                    // ...
                };
</pre></div>


<p>这样配置就变得清晰，便于编辑<br />
最后形成具体表格给策划使用的时候，就看策划喜欢那种方式，如果喜欢他全部item属性都放在一张里面，你就给他一张表包括所有属性，再在制作资源的时候通过<strong>脚本(或者其他方法)</strong>将配置表拆分成不同的表方便程序阅读<br />
如果策划喜欢将配置放在不同的表格里面，这种情况下需要确保的配置的uid对应正确，所以程序这边也需要做一些辅助脚本帮其检测更好。</p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

</body>
</html>